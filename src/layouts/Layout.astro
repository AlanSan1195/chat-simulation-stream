---
import "../styles/global.css";
import Fotter from "../components/Fotter.astro";

interface Props {
  title: string;
  description?: string;
  image?: string;
  type?: "website" | "article";
  noindex?: boolean;
}

const {
  title,
  description = "Practica streaming con una audiencia simulada. Rocket Chat Simulator genera comentarios realistas de Twitch/YouTube para que practiques antes de tu primer stream.",
  image = "/desktop-hero-dark.png",
  type = "website",
  noindex = false,
} = Astro.props;

const canonicalURL = new URL(
  Astro.url.pathname,
  Astro.site || "https://rocketchat.online",
);
const imageURL = new URL(image, Astro.site || "https://rocketchat.online");

// Structured Data JSON-LD
const structuredData = {
  "@context": "https://schema.org",
  "@type": "WebApplication",
  name: "Rocket Chat Simulator",
  description: description,
  url: canonicalURL.href,
  applicationCategory: "Utility",
  operatingSystem: "Web Browser",
  offers: {
    "@type": "Offer",
    price: "0",
    priceCurrency: "USD",
  },
  creator: {
    "@type": "Person",
    name: "Alan San",
  },
  keywords:
    "chat simulator, twitch, youtube, streaming, streamer, practice, simulador de chat, stream practice",
};
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />
    <meta name="author" content="Alan San" />
    <meta
      name="keywords"
      content="chat simulator, simulador de chat, twitch chat, youtube chat, streaming practice, practica streaming, streamer tools, herramientas streamer, fake chat, chat de prueba, stream simulator"
    />
    <meta
      name="robots"
      content={noindex ? "noindex, nofollow" : "index, follow"}
    />
    <meta
      name="googlebot"
      content={noindex ? "noindex, nofollow" : "index, follow"}
    />

    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL.href} />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/logo-rocket.svg" />
    <link rel="apple-touch-icon" href="/logo-rocket.svg" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content={type} />
    <meta property="og:url" content={canonicalURL.href} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={imageURL.href} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="Rocket Chat Simulator" />
    <meta property="og:locale" content="es_ES" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalURL.href} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={imageURL.href} />
    <meta
      name="twitter:image:alt"
      content="Rocket Chat Simulator - Practica streaming con audiencia simulada"
    />

    <!-- Theme Color -->
    <meta name="theme-color" content="#9146FF" />
    <meta name="msapplication-TileColor" content="#9146FF" />

    <!-- Generator -->
    <meta name="generator" content={Astro.generator} />

    <!-- Structured Data JSON-LD -->
    <script
      type="application/ld+json"
      set:html={JSON.stringify(structuredData)}
    />

    <!-- Preconnect a servicios externos -->
    <link rel="preconnect" href="https://clerk.rocketchat.online" />
    <link rel="dns-prefetch" href="https://clerk.rocketchat.online" />
    <!-- Aplicar color de plataforma antes del primer render para evitar flash -->
    <script is:inline>
      (function () {
        var platforms = {
          twitch: { color: "#9146FF", textColor: "#ffffff" },
          kick: { color: "#53FC18", textColor: "#0a1a00" },
        };
        var stored = localStorage.getItem("preferred-platform");
        var p = platforms[stored] || platforms.twitch;
        document.documentElement.style.setProperty("--color-primary", p.color);
        document.documentElement.style.setProperty(
          "--color-primary-text",
          p.textColor,
        );
      })();
    </script>
  </head>
  <body class="bg-bg-secundary dark:bg-black text-black dark:text-white min-h-screen">

    <!-- Emerald Void â€” solo dark mode -->
    <div
      class="hidden dark:block fixed inset-0 -z-10 pointer-events-none"
      style="background: radial-gradient(125% 125% at 0% 10%, #000000 60%, var(--color-bg-void) 100%);"
      aria-hidden="true"
    >
    </div>

    <div id="clerk-root" class="locative z-10">
      <slot />
    </div>
    <Fotter />
  </body>
</html>
